<!DOCTYPE html>

<html lang="en">
  <head>
    <!-- search engines -->
    <link rel="canonical" href="https://omeo.one/explained.html">

    <!-- https://developer.mozilla.org/en-US/docs/Web/HTML/Element/meta -->
    <meta charset="utf-8">
    <meta content="initial-scale=1, width=device-width" name="viewport">

    <!-- favicon; generated by https://realfavicongenerator.net/ -->
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
    <link rel="manifest" href="site.webmanifest">
    <link rel="mask-icon" href="safari-pinned-tab.svg" color="#202a0e">
    <meta name="apple-mobile-web-app-title" content="OMEO">
    <meta name="application-name" content="OMEO">
    <meta name="msapplication-TileColor" content="#202a0e">
    <meta name="theme-color" content="#202a0e">

    <!-- own content -->
    <link href="styles/styles.css?v=54169068" rel="stylesheet">

    <title>OMEO - Explained</title>
    <meta name="description" content="A detailed explanation on how Minecraft enchantment combining works using the anvil.">
  </head>

  <body>
    <div class="patreonIcon">
      <a href="https://patreon.com/OMEO" target="_blank">
        <img src="images/patreon.png" alt=""><br>
        <span class="firstLetter">P</span>atreon
      </a>
    </div>

    <div class="content firstContent turquoise">
      <div id="banner">
        <a href="index.html"><div class="letter"><img src="images/o1.png" alt="O"></div><div class="letter"><img src="images/m.png" alt="M"></div><div class="letter"><img src="images/e.png" alt="E"></div><div class="letter"><img src="images/o2.png" alt="O"></div></a><br>
        <span class="subtitle">Explained</span>
      </div>

      <p>A brief explanation for anyone curious enough to care.</p>

      <p>Disclaimer: described below is how the Java edition of Minecraft works. Other Minecraft editions basically function the same, but there are some differences here and there which make the final cost calculations not line up.</p>
    </div>

    <div class="content azure">
      <h1>Enchanting details</h1>

      <p>When working with item enchantments, there are a couple of things that are at play. These are described in detail <a href="https://minecraft.fandom.com/wiki/Anvil_mechanics" target="_blank">on the wiki</a>. The details relevant to OMEO are listed below.</p>

      <dl>
        <dt>Prior work penalty (read: 'anvil use count')</dt>
          <dd>All items start at a prior work penalty of zero. Every time you do something with an item on the anvil, the item's prior work penalty is increased. The only exception is if you purely (re)name an item; this doesn't increase the item's prior work penalty. The maximum prior work penalty an item can get before it becomes too costly to process any further is five.<br>
          If you do not know an item's prior work penalty, you can find it out by placing it on an anvil and initiating a rename -- you do not have to actually rename it;
              <ul>
                <li>place it on the anvil,</li>
                <li>type another name for it,</li>
                <li>note down how much XP levels that would cost,</li>
                <li>look up the prior work penalty using the following table:
                  <table class="table">
                    <thead>
                      <tr>
                        <th>XP level<br>cost</th><th>Prior work<br>penalty</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr><td>1</td><td>0</td></tr>
                      <tr><td>2</td><td>1</td></tr>
                      <tr><td>4</td><td>2</td></tr>
                      <tr><td>8</td><td>3</td></tr>
                      <tr><td>16</td><td>4</td></tr>
                      <tr><td>32</td><td>5</td></tr>
                    </tbody>
                  </table>
                </li>
              </ul>
          </dd>
        <dt>Anvil cost limit</dt>
          <dd>Using the anvil costs XP levels. The total cost of the operations on the anvil depends on what you do, but it cannot exceed 39 XP levels. If the total cost exceeds this limit, you will be told the operation is &quot;Too expensive!&quot; Prior work penalties play a significant role in the final cost, so it's important to give OMEO the correct prior work penalties when listing your items.</dd>
        <dt>Enchanting an item on the enchanting table</dt>
          <dd>When giving an item enchantment(s) using the enchantment table, its prior work penalty doesn't change.</dd>
        <dt>Repairing items on the workbench</dt>
          <dd>When you repair an item on the workbench by combining it with another identical item or with its base ingredients, the resulting item will have more durability. However, all enchantments, names and prior work penalties present on the used items will get lost. This is thus a valid way to reset an item's prior work penalty, though doing so with a grindstone is often more beneficial.</dd>
        <dt>Removing enchantments with a grindstone</dt>
          <dd>When removing enchantments with a grindstone, you'll get back a portion of the XP that was present in the item. All enchantments as well as the prior work penalty will be removed (except for curses), and the item's name will stay. So, if an item doesn't have a curse on it, this could be a preferred way to remove any prior work penalty from an item.</dd>
        <dt>Repairing and combining items on the anvil</dt>
          <dd>You can use the anvil to combine two items or an item and a book. Doing so, the left one will be the target item, while the right one will be the sacrifice item. When you extract the combined item from the anvil, the sacrifice item is destroyed in the process. If you combine two items, the target item will be repaired in the same way as when you would have done so on a workbench. The difference is that the enchantments that were present on the starting items will combine and be placed on the resulting item (if possible). This does come at the cost of XP though. The resulting item's prior work penalty is set to the highest prior work penalty of the two items being combined, plus one additional level. Also note that using books is generally a more economical way to get enchants on an item.<br>
          When solely repairing an item on the anvil using the item's repair material (iron ingots, diamonds, etc.) the item will retain its enchantments and name, but its prior work penalty will be increased nonetheless. This way of repairing items will thus become costly quite soon and thus unsustainable in the long term. Repairing items this way is out of scope for OMEO; see the wiki for further details if you are interested.</dd>
        <dt>(Re)naming an item on the anvil</dt>
          <dd>You can use the anvil to give an item a name or change its existing name. This will not increase the item's prior work penalty, but it will cost one XP level plus any prior work penalty present on the item. Renaming is still possible once the prior work penalty becomes too high; the XP level required for a rename is capped at 39. It is thus most economical to rename an item as soon as possible, or to rename it while also upgrading it.<br>
          When you are combining an item with another item on the anvil <em>and</em> rename it as well, this rename will only cost that one additional XP level. Be careful though: when that one extra XP level would make the total anvil cost pass 39 XP levels, the combine (and thus rename) will be impossible!</dd>
      </dl>
    </div>

    <div class="content olive">
      <h1>Anvil cost calculations</h1>

      <p>The total cost for combining items on the anvil is a combination of several pieces;</p>

      <dl>
        <dt>Rename cost</dt>
          <dd>If you also rename the item, this adds an extra <em>1 XP level</em>.</dd>
        <dt>Repair cost</dt>
          <dd>If an item is going to be repaired in the process (either with raw materials or by combining broken items), this will add an additional <em>2 XP levels</em>.</dd>
        <dt>Enchantment cost</dt>
          <dd>Each enchantment the target item already has that the sacrifice item doesn't will cost <em>no XP levels</em>. Each enchantment the sacrifice item adds to or increases on the target item will cost XP levels;
            <ul>
              <li>Target cannot have the enchantment: the enchantment is dropped, costing <em>no XP levels</em>. Example: looting on a chestplate.</li>
              <li>Target already has an incompatible enchantment: the sacrifice's enchantment is lost, but still adds <em>1 XP level</em>. Except when combining books with Silk Touch and Luck of the Sea or Looting, which is impossible.</li>
              <li>Target can have the enchantment: this costs <em>the final enchantment level</em>, multiplied by <em>the matching multiplier</em> for the sacrifice's type (whether it's a book or an item).
                <ul>
                  <li>The final level depends on the enchantment level the target already has compared to the sacrifice item;
                    <ul>
                      <li>Target doesn't have the enchantment or has it at a lower level than the sacrifice item: the final level will be the same as the sacrifice item's level.</li>
                      <li>Target has the enchantment at the same level: the final level will be one higher than the target and sacrifice item's level (keeping the enchantment's max level in mind).</li>
                      <li>Target has the enchantment at a higher level: the final level is the same as the target item's level.</li>
                    </ul>
                  </li>
                  <li>The multipliers are:
                    <table class="table">
                      <thead>
                        <tr><th>Book multiplier</th><th>Item multiplier</th><th>Applicable to enchantments</th></tr>
                      </thead>
                      <tbody>
                        <tr><td>1</td><td>1</td><td>Efficiency, Piercing, Power, Protection, Sharpness</td></tr>
                        <tr><td>1</td><td>2</td><td>Bane of Arthropods, Density, Feather Falling, Fire Protection, Knockback, Loyalty, Lunge, Projectile Protection, Quick Charge, Smite, Unbreaking</td></tr>
                        <tr><td>2</td><td>4</td><td>Aqua Affinity, Blast Protection, Breach, Depth Strider, Fire Aspect, Flame, Fortune, Frost Walker, Impaling, Looting, Luck of the Sea, Lure, Mending, Multishot, Punch, Respiration, Riptide, Sweeping Edge, Wind Burst</td></tr>
                        <tr><td>4</td><td>8</td><td>Channeling, Curse of Binding, Curse of Vanishing, Infinity, Silk Touch, Soul Speed, Swift Sneak, Thorns</td></tr>
                      </tbody>
                    </table>
                    <p>These multipliers can be found in the original game files. On Windows, go to your %appdata% folder, then browse to <code>.minecraft/versions/[version nr]/[version nr].jar</code>. This is actually a zip file; open or extract it, and browse to the folder <code>data/minecraft/enchantment</code>. In that folder you will find one json file per enchantment, and in those files you will find the <code>anvil_cost</code>. This is actually the Item multiplier from the table above; the Book multiplier can be obtained by halving it if it is bigger than 1.</p>
                    <p>To test the multipliers in-game, you can <code>/give</code> yourself clean items (without prior work penalties etc.), place them on an anvil, and note the cost it would give. To e.g. test the multipliers for Thorns, give yourself some unenchanted leggings, some pre-enchanted leggings with Thorns, and some books with only Thorns;
                      <pre>/give @p diamond_leggings 1
/give @p diamond_leggings[enchantments={thorns:1}] 2
/give @p diamond_leggings[enchantments={thorns:2}] 2
/give @p enchanted_book[stored_enchantments={thorns:1}] 2
/give @p enchanted_book[stored_enchantments={thorns:2}] 2</pre>
                      After this, you can test combinations to deduce the multipliers; these should all line up. The multiplier is the observed cost, divided by the final level.
                      <table class="table">
                        <thead>
                          <tr><td>Multiplier</td><td>Target item</td><td>Sacrifice item</td><td>Final level</td><td>Cost</td><td>Multiplier></td></tr>
                        </thead>
                        <tbody>
                          <tr><td>Book</td><td>Leggings</td><td>Book Thorns I</td><td>1</td><td>4</td><td>4</td></tr>
                          <tr><td>Book</td><td>Leggings</td><td>Book Thorns II</td><td>2</td><td>8</td><td>4</td></tr>
                          <tr><td>Book</td><td>Book Thorns I</td><td>Book Thorns I</td><td>2</td><td>8</td><td>4</td></tr>
                          <tr><td>Book</td><td>Book Thorns II</td><td>Book Thorns II</td><td>3</td><td>12</td><td>4</td></tr>
                          <tr><td>Item</td><td>Leggings Thorns I</td><td>Leggings Thorns I</td><td>2</td><td>16</td><td>8</td></tr>
                          <tr><td>Item</td><td>Leggings Thorns II</td><td>Leggings Thorns II</td><td>3</td><td>24</td><td>8</td></tr>
                        </tbody>
                      </table>
                    </p>
                  </li>
                </ul>
              </li>
            </ul>
          </dd>
        <dt>Prior work penalty</dt>
          <dd>Take the highest prior work penalty from both items (target and sacrifice) and use the table below to determine the XP level cost.
            <table class="table">
              <thead>
                <tr>
                  <th>Prior work<br>penalty</th><th>XP&nbsp;level<br>cost</th>
                </tr>
              </thead>
              <tbody>
                <tr><td>0</td><td>0</td></tr>
                <tr><td>1</td><td>1</td></tr>
                <tr><td>2</td><td>3</td></tr>
                <tr><td>3</td><td>7</td></tr>
                <tr><td>4</td><td>15</td></tr>
                <tr><td>5</td><td>31</td></tr>
              </tbody>
            </table>
          </dd>
      </dl>
    </div>

    <div class="content red">
      <h1>Finding the right combinations</h1>

      <p>There are two approaches when finding out the best way to plan your enchantments: start at the individual items and build your way up to the desired final item, or start at the final item and work your way down to the individual items. In this case the latter is far more complicated to manage, while the former results in not only getting at the desired item (if possible), but also all other items that can be created. OMEO therefore uses the former option.</p>

      <p>There is no guarantee the desired item can be made from the inputs. We want to show a list of the options coming close in that case, and not just tell that it's impossible to get there. There is also the possibility something even better can be made, which would also be nice to know about. The best way to go about this is to just spit out all relevant possible combinations, and sort that list by the matching score.</p>

      <div class="keepTogether">
        <p>To get at all possible combinations,</p>
        <ul>
          <li>OMEO places all source items the user added into an item pool.</li>
          <li>If the desired item is not a book, and if all source items of that type have enchantments on them or have a prior work penalty, OMEO also throws in a fresh unenchanted item of that type (because that could be a better start than any of the enchanted and/or prior work penaltied source items).</li>
          <li>It then starts making all relevant combinations between all items, putting all combined items back into the pool to continue combining those even further.</li>
          <li>OMEO takes care to combine all items in both ways (because one way could be less costly than the other).</li>
          <li>When combining, OMEO skips those combinations where both predecessors share a common constituting item (we can't double dip here).</li>
          <li>OMEO chugs along until there are no combinations left to be made. Due to the nature of this process, this can however take <em>quite</em> a while... But the chapter below describes how OMEO deals with this issue.</li>
        </ul>
      </div>
    </div>

    <div class="content yellow">
      <h1>Strippin' the bloat</h1>

      <p>This is unfortunately a very unsatisfying process, since the number of combinations quickly skyrockets beyond what a computer can handle. E.g., if the user added 10 items, combining these could add up to 10 * 10 = 100 extra items to consider. And these in turn could add up to 110 * 110 = 12,100 extra items, going to 146,410,000 items for the next round, etc. This thus more than squares with each pass, and there can be up to six passes needed to reach the end.</p>

      <div class="keepTogether">
        <p><em>However...</em> there are lots of corners to be cut here, making the process manageable;</p>
        <ul>
          <li>We don't need to combine items when the combine cost is higher than 39, since the anvil rejects these combines as &quot;Too expensive&quot;.</li>
          <li>Not all combinations are possible, like combining an item with one of its constituting items earlier in the list.</li>
          <li>Some combinations are not even a consideration because of mismatching item type (using a book as target and a non-book as sacrifice, or trying to combine two different non-book items).</li>
          <li>Some combinations are just wasteful, like combining a lower level enchant to a higher level one (making the combine useless by completely wasting one of the items while still costing XP in the process).</li>
          <li>When combining two items the result depends on which one you use as the target and which one as the sacrifice. This also goes for the cost. But in case they both end up on the same configuration (enchantments and levels wise), we can drop the uninteresting most expensive one.</li>
          <li>When adding lots of e.g. Efficiency 1 books, it's far easier to lump them all together and keep track of how many we had to begin with. This effectively reduces a whole swath of items back to one item, heavily curbing the growth.</li>
          <li>We try out all item combinations. But if we later find a certain item combination that results in the same item as one we combined before from the same constituting items, we can drop one of them if it is strictly less interesting in all regards (higher prior work penalty, higher total cost and greater number of constituting ingredients). It could turn out that we can drop a previously combined item which was already used as an ingredient for further combinations. In that case all those derived items can also be thrown away, since we will recreate them in a better way with the newly found better combination as a base. Doing this however means the progress will effectively be rewound (quite) a few steps; this is the reason OMEO's progress can sometimes temporarily count down! This is thus a feature to keep the processing time manageable, and not a bug :)</li>
          <li>Some combinations are useless, like combining with items that only have enchantments we don't need on the final item. <span class="footnote">(not implemented yet)</span></li>
        </ul>
      </div>

      <p>When also using these extra rules, the total number of possibilities is often quite manageable.</p>
    </div>

    <div class="content violet">
      <h1>Other options</h1>

      <div class="keepTogether">
        <p>The anvil offers extra options while working with enchantments. These are not considered by OMEO;</p>
        <ul>
          <li>Some damaged tools can be repaired as well by throwing ingots, leather, etc. at them. This costs 1 xp level per ingot and increases the prior work counter for the tool. However, this cannot be performed in the same step as an enchantment combine. So, if a tool needs to be repaired this way, it should be done before or after the steps from the divination result. If done before, this must be specified by correctly specifying the tool's new prior work penalty in the form. If done after, the repair cost (incl. the final combined tool's prior work counter) should be taken into account by the user. Then again costly tools are probably getting a 'mending' on them as well, in which case repairing the tool this way is an unnecessary costly step anyway.</li>
          <li>Damaged tools will be repaired implicitly when combined with another tool. This will cost an extra 2 xp levels per repair. Implicit repairing may happen more than once; a combined tool's durability is the sum of the target + sacrifice tool's durability, plus an extra 12%. This means a combine of two quite damaged tools will result in a still damaged tool (though less so than the original tool). Depending on when in the combine process damaged tools get combined together, this might or might not influence whether the repair would increase the total cost past the max 39 xp levels. While this could be taken into account perfectly fine, it would require the user to enter the durability of the items as well (e.g. on a 0% to 100% scale). And this adds too much clutter to the form to make it worthwhile IMO.</li>
        </ul>
      </div>
    </div>

    <div class="content grey">
      <h1>Obligatory disclaimer</h1>

      <p>Copyright &copy; 2024. All rights reserved. This site is for personal use only. By using this website you agree to the privacy policy as stated on the main page.</p>

      <p>OMEO is not affiliated with Minecraft, Microsoft or Mojang. Minecraft and any artwork or screenshots relating to these are the intellectual property of Microsoft; all rights are reserved worldwide.</p>
    </div>
  </body>
</html>