<!DOCTYPE html>

<html lang="en">
  <head>
    <!-- https://developer.mozilla.org/en-US/docs/Web/HTML/Element/meta -->
    <meta charset="utf-8">
    <meta content="initial-scale=1, width=device-width" name="viewport">

    <!-- favicon; generated by https://realfavicongenerator.net/ -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#202a0e">
    <meta name="apple-mobile-web-app-title" content="OMEO">
    <meta name="application-name" content="OMEO">
    <meta name="msapplication-TileColor" content="#202a0e">
    <meta name="theme-color" content="#202a0e">

    <!-- own content -->
    <link href="styles/styles.css" rel="stylesheet">

    <title>OMEO - Explained</title>
  </head>

  <body>
    <h1>
      <div class="letter"><img src="images/o1.png"></div>
      <div class="letter"><img src="images/m.png"></div>
      <div class="letter"><img src="images/e.png"></div>
      <div class="letter"><img src="images/o2.png"></div><br>
      <i>-- EXPLAINED --</i>
    </h1>

    <h2>Finding the right combinations</h2>

    <p>There are two approaches when finding out the best way to get from A to B: start at A or start at B. Or in this case: start at the individual items and build your way up to the desired final item, or start at the final item and work your way down to the individual items. In this case the latter is far more complicated to manage, while the former results in not only getting at the desired item (if possible), but also all other items that can be created. OMEO therefore uses the former option.</p>

    <p>Since there is no guarantee the desired item can be made from the inputs, we want to show a list of options coming close. The best way to get there is to just spit out all possible combinations, and sort the final list by best matching.</p>

    <div class="keepTogether">
      <p>To get at all possible combinations, OMEO:</p>
      <ul>
        <li>Places all items the user added into an item pool (pool 1).</li>
        <li>If the desired item is a true item (e.g. not a book) and has enchantments on it, it optionally also throws in an unenchanted item of that type (because that could be a better start than the user-added item).</li>
        <li>It then makes all possible item combinations from pool 1, and puts them in pool 2, taking care to combine all items in both ways (because the reverse way could be less costly).</li>
        <li>It then makes all possible item combinations from pool 1 &amp; pool 2 combined, and puts them in pool 3.</li>
        <li>... etc.</li>
      </ul>
    </div>

    <p>This is unfortunately a very unsatisfying process, since the number of combinations quickly skyrockets beyond what your device can handle. E.g., if the user added 10 items, then pool 2 would get 10 * 10 = 100 combined items, pool 3 would get 110 * 100 = 11,000 items, pool 4 would get 1,210,000 items, etc., more than squaring with each pass!</p>

    <div class="keepTogether">
      <p><em>However...</em> there are lots of corners to be cut here, making the process manageable;</p>
      <ul>
        <li>We don't need to combine items when the combine cost is higher than 39, since the anvil rejects these combines as &quot;Too expensive&quot;.</li>
        <li>Not all combinations are possible, like combining two items from pool 2 which both share the same constructing item from pool 1.</li>
        <li>Some combination are not even a consideration because of mismatching item type (using a book as target and a non-book as sacrifice, or trying to combine two different non-book items).</li>
        <li>Some combinations are just wasteful, like combining a lower-level enchant to a higher-level one (making the combine useless by completely wasting one of the items).</li>
        <li>When combining two items the end result depends on which one you use as the target and which one as the sacrifice.  This goes also for the cost.  But in case they both end up on the same configuration (enchantments + levels), we can drop the uninteresting most expensive one.</li>
        <li>When adding lots of e.g. Effciency 1 books, it's far easier to lump them all together and keep track of how many we had to begin with.  This effectively reduces a whole swath of items back to 1 item, curbing the growth hugely.</li>
        <li>Some combinations are useless, like combining with items that only have enchantments we don't need on the final item. <span class="footnote">(not implemented yet)</span></li>
      </ul>
    </div>

    <p>When also using these extra rules the total number of possibilities is often quite manageable.  Or at least, I hope so...</p>

    <h2>Other options</h2>

    <div class="keepTogether">
      <p>The anvil offers extra options while working with enchantments. These are not taken into account by OMEO;</p>
      <ul>
        <li>A tool can be renamed as well. However, this will only cost one extra exp. level when performed along a combine. So the best time to do the rename is during the tool's first combine, where the cost will generally not be an issue yet. The only exception is if the tool is already at a very high work level from the start, but this should be exceptional enough not to worry about it during the divination process.</li>
        <li>Some damaged tools can be repaired as well by throwing ingots, leather, etc. at them. This costs 1 exp. level per ingot, and increases the prior work counter for the tool. However, this cannot be performed in the same step as an enchantment combine. So if a tool needs to be repaired this way, it should be done before or after the steps from the divination result. If done before, this can be compensated for by adjusting the tool's 'prior work' field in the form. If done after, the repair cost (incl. the final combined tool's prior work counter) should be taken into account by the user. Then again costly tools are probably getting a 'mending' on them as well, in which case repairing the tool this way is an unnecessary costly step anyway.</li>
        <li>Damaged tools will be repaired implictly when combined with another tool. This will cost an extra 2 exp. levels per repair. Implicit repairing may happen more than once; a combined tool's durability is the sum of the target + sacrifice tool's durability, plus an extra 12%. This means a combine of two quite damaged tools will result in a still damaged tool (though less so than the original tool). Depending on when in the combine process damaged tools get combined together, this might or might not influence whether the repair would increase the total cost past the max 39 exp. levels. While this could be taken into account perfectly fine, it would require the user to enter the durability of the items as well (e.g. on a 0% to 100% scale). And this adds too much clutter to the form to make it worthwhile IMO.</li>
      </ul>
    </div>
  </body>
</html>